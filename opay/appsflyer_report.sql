CREATE EXTERNAL TABLE IF NOT EXISTS opay_dw.log_appsflyer_performance_di (
    `date` string,
    country string,
    agency_pmd_af_prt string,
    media_source_pid string,
    campaign_c string,
    impressions string,
    clicks string,
    ctr string,
    installs string,
    conversion_rate string,
    sessions string,
    loyal_users string,
    loyal_users_installs string,
    total_revenue string,
    total_cost string,
    roi string,
    arpu string,
    average_ecpi string,
    choose_end_point_click_unique_users string,
    choose_end_point_click_event_counter string,
    choose_end_point_click_sales_in_usd string,
    choose_end_point_show_unique_users string,
    choose_end_point_show_event_counter string,
    choose_end_point_show_sales_in_usd string,
    choose_starting_point_click_unique_users string,
    choose_starting_point_click_event_counter string,
    choose_starting_point_click_sales_in_usd string,
    choose_starting_point_show_unique_users string,
    choose_starting_point_show_event_counter string,
    choose_starting_point_show_sales_in_usd string,
    complete_the_order_return_unique_users string,
    complete_the_order_return_event_counter string,
    complete_the_order_return_sales_in_usd string,
    complete_the_order_show_unique_users string,
    complete_the_order_show_event_counter string,
    complete_the_order_show_sales_in_usd string,
    complete_the_payment_show_unique_users string,
    complete_the_payment_show_event_counter string,
    complete_the_payment_show_sales_in_usd string,
    estimated_price_click_return_unique_users string,
    estimated_price_click_return_event_counter string,
    estimated_price_click_return_sales_in_usd string,
    estimated_price_cllick_request_unique_users string,
    estimated_price_cllick_request_event_counter string,
    estimated_price_cllick_request_sales_in_usd string,
    estimated_price_show_unique_users string,
    estimated_price_show_event_counter string,
    estimated_price_show_sales_in_usd string,
    existing_end_address_click_unique_users string,
    existing_end_address_click_event_counter string,
    existing_end_address_click_sales_in_usd string,
    existing_starting_address_click_unique_users string,
    existing_starting_address_click_event_counter string,
    existing_starting_address_click_sales_in_usd string,
    fill_out_end_address_click_unique_users string,
    fill_out_end_address_click_event_counter string,
    fill_out_end_address_click_sales_in_usd string,
    fill_out_starting_address_clilck_unique_users string,
    fill_out_starting_address_clilck_event_counter string,
    fill_out_starting_address_clilck_sales_in_usd string,
    invitation_code_click_unique_users string,
    invitation_code_click_event_counter string,
    invitation_code_click_sales_in_usd string,
    looking_for_a_driver_click_cancel_unique_users string,
    looking_for_a_driver_click_cancel_event_counter string,
    looking_for_a_driver_click_cancel_sales_in_usd string,
    looking_for_a_driver_click_return_unique_users string,
    looking_for_a_driver_click_return_event_counter string,
    looking_for_a_driver_click_return_sales_in_usd string,
    looking_for_a_driver_show_unique_users string,
    looking_for_a_driver_show_event_counter string,
    looking_for_a_driver_show_sales_in_usd string,
    open_oride_click_banner_unique_users string,
    open_oride_click_banner_event_counter string,
    open_oride_click_banner_sales_in_usd string,
    open_oride_click_takearide_unique_users string,
    open_oride_click_takearide_event_counter string,
    open_oride_click_takearide_sales_in_usd string,
    oride_click_return_unique_users string,
    oride_click_return_event_counter string,
    oride_click_return_sales_in_usd string,
    oride_cllick_request_unique_users string,
    oride_cllick_request_event_counter string,
    oride_cllick_request_sales_in_usd string,
    oride_show_unique_users string,
    oride_show_event_counter string,
    oride_show_sales_in_usd string,
    pay_online_click_pay_unique_users string,
    pay_online_click_pay_event_counter string,
    pay_online_click_pay_sales_in_usd string,
    request_a_ride_click_requestimmediately_unique_users string,
    request_a_ride_click_requestimmediately_event_counter string,
    request_a_ride_click_requestimmediately_sales_in_usd string,
    request_a_ride_click_return_unique_users string,
    request_a_ride_click_return_event_counter string,
    request_a_ride_click_return_sales_in_usd string,
    request_a_ride_show_unique_users string,
    request_a_ride_show_event_counter string,
    request_a_ride_show_sales_in_usd string,
    rider_arrive_show_unique_users string,
    rider_arrive_show_event_counter string,
    rider_arrive_show_sales_in_usd string,
    start_ride_click_phone_unique_users string,
    start_ride_click_phone_event_counter string,
    start_ride_click_phone_sales_in_usd string,
    start_ride_show_unique_users string,
    start_ride_show_event_counter string,
    start_ride_show_sales_in_usd string,
    successful_order_click_cancel_unique_users string,
    successful_order_click_cancel_event_counter string,
    successful_order_click_cancel_sales_in_usd string,
    successful_order_click_return_unique_users string,
    successful_order_click_return_event_counter string,
    successful_order_click_return_sales_in_usd string,
    successful_order_show_unique_users string,
    successful_order_show_event_counter string,
    successful_order_show_sales_in_usd string,
    webview_loadtime_unique_users string,
    webview_loadtime_event_counter string,
    webview_loadtime_sales_in_usd string
) PARTITIONED BY (dt STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
STORED AS TEXTFILE
LOCATION 'ufile://opay-datalake/opay/appsflyer/performance_log'
TBLPROPERTIES ('skip.header.line.count'='1');



CREATE EXTERNAL TABLE IF NOT EXISTS opay_dw.log_appsflyer_install_di (
    attributed_touch_type string,
    attributed_touch_time string,
    install_time string,
    event_time string,
    event_name string,
    event_value string,
    event_revenue string,
    event_revenue_currency string,
    event_revenue_usd string,
    event_source string,
    is_receipt_validated string,
    partner string,
    media_source string,
    channel string,
    keywords string,
    campaign string,
    campaign_id string,
    adset string,
    adset_id string,
    ad string,
    ad_id string,
    ad_type string,
    site_id string,
    sub_site_id string,
    sub_param_1 string,
    sub_param_2 string,
    sub_param_3 string,
    sub_param_4 string,
    sub_param_5 string,
    cost_model string,
    cost_value string,
    cost_currency string,
    contributor_1_partner string,
    contributor_1_media_source string,
    contributor_1_campaign string,
    contributor_1_touch_type string,
    contributor_1_touch_time string,
    contributor_2_partner string,
    contributor_2_media_source string,
    contributor_2_campaign string,
    contributor_2_touch_type string,
    contributor_2_touch_time string,
    contributor_3_partner string,
    contributor_3_media_source string,
    contributor_3_campaign string,
    contributor_3_touch_type string,
    contributor_3_touch_time string,
    region string,
    country_code string,
    state string,
    city string,
    postal_code string,
    dma string,
    ip string,
    wifi string,
    operator string,
    carrier string,
    language string,
    appsflyer_id string,
    advertising_id string,
    idfa string,
    android_id string,
    customer_user_id string,
    imei string,
    idfv string,
    platform string,
    device_type string,
    os_version string,
    app_version string,
    sdk_version string,
    app_id string,
    app_name string,
    bundle_id string,
    is_retargeting string,
    retargeting_conversion_type string,
    attribution_lookback string,
    reengagement_window string,
    is_primary_attribution string,
    user_agent string,
    http_referrer string,
    original_url string,
    install_app_store string,
    contributor_1_match_type string,
    contributor_2_match_type string,
    contributor_3_match_type string,
    match_type string,
    device_category string,
    google_play_referrer string,
    google_play_click_time string,
    google_play_install_begin_time string,
    amazon_fire_id string,
    keyword_match_type string
) PARTITIONED BY (dt STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
STORED AS TEXTFILE
LOCATION 'ufile://opay-datalake/opay/appsflyer/install_log'
TBLPROPERTIES ('skip.header.line.count'='1');